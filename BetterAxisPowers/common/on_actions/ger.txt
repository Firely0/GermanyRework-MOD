on_actions = {
	on_startup = {
		effect = {
			GER = {
				remove_ideas = Wehrmacht
				remove_ideas = Luftwaffe
				remove_ideas = Kriegsmarine
				add_ideas = Wehrmacht_Main_inf
				add_ideas = Luftwaffe_debuff
				add_ideas = Kriegsmarine_Debuff_Version
			}
			ITA = {
				add_ideas = ITA_GER_TRAINING
			}
			SOV = {
				add_ideas = SOV_GER_TRAINING
				set_research_slots = 4
				set_variable = { SOV_TANK_DEVELOP_TIME = 180 }
			}
			if = {
				limit = {
					GER = {
						is_ai = yes
					}
				}
				GER = {
					set_technology = { mobile_warfare = 1 popup = no }
					add_ideas = i_dont_use_wargoal
				}
			}
		}
	}
	on_startup = {
		effect = {
			GER = {
				diplomatic_relation = {
					country = POL
					relation = non_aggression_pact
					active = yes
				}
			}
			SOV = {
				diplomatic_relation = {
					country = POL
					relation = non_aggression_pact
					active = yes
				}
			}
			ROM = {
				diplomatic_relation = {
					country = POL
					relation = non_aggression_pact
					active = yes
				}
			}
		}
	}
	on_join_faction = {
		effect = {
			if = {
				limit = {
					NOT = {
						has_global_flag = DONT_ABUSE_ITA_FACTION
					}
					original_tag = ITA
					has_government = fascism
					ITA = {
						has_war_with = ETH
						is_ai = yes
					}
					ETH = {
						has_war_with = ITA
						is_government_in_exile = yes
					}
				}
				ITA = {
					add_ideas = ita_dont_core_about_eth
				}
				set_global_flag = DONT_ABUSE_ITA_FACTION
			}
		}
	}
	
	on_weekly = {
		effect = {
			if = {
				limit = {
					has_global_flag = GER_FIN_granted_lands
					is_in_faction_with = GER
					any_state = {
						has_state_flag = GER_FIN_granted_lands_state
						OR = {
							is_controlled_by = GER
							controller = {
								is_in_faction_with = GER
								NOT = { tag = FIN }
								NOT = { owns_state = PREV } #Not owner (it should be actually occupating the state -> Also prevents the issue in YUG with IMRO removing the core)
								NOT = { PREV = { is_core_of = PREV } }
							}
						}
					}
				}
				country_event = GER_FIN_lands.1
			}
		}
	}

	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM = {
						original_tag = GER
						has_war = yes
						has_power_balance = {
							id = GER_power_balance
						}
						is_power_balance_side_active = {
							id = GER_power_balance
							side = default_left_side
						}
					}
					FROM.FROM = {
						is_owned_by = GER
					}
				}
				if = {
					limit = {
						FROM.FROM = {
							is_core_of = GER
						}
					}
					if = {
						limit = {
							FROM = {
								check_variable = {
									GER_lost_core = 0
								}
							}
						}
						FROM = {
							set_variable = {
								GER_lost_core = FROM.FROM
							}
							country_event = {
								id = ger_lost_core.1
								hours = 1
							}
						}
					}
					else = {
						GER_bop_medium_decrease_effect = yes
						GER_bop_increase_lost_core_modifier = yes
					}
				}
			}
			else_if = {
				limit = {
					ROOT = {
						original_tag = GER
						has_war = yes
						has_power_balance = {
							id = GER_power_balance
						}
						is_power_balance_side_active = {
							id = GER_power_balance
							side = default_right_side
						}
					}
					FROM.FROM = {
						is_owned_by = GER
					}
				}
				if = {
					limit = {
						FROM.FROM = {
							is_core_of = GER
						}
					}
					if = {
						limit = {
							check_variable = {
								GER_reclaimed_core = 0
							}
						}
						set_variable = {
							GER_reclaimed_core = FROM.FROM
						}
						country_event = {
							id = ger_lost_core.2
							hours = 1
						}
					}
					else = {
						GER_bop_medium_increase_effect = yes
						GER_bop_decrease_lost_core_modifier = yes
					}
				}
				else = {
					GER_bop_very_low_increase_effect = yes
				}
			}
		}
	}
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					tag = GER
					has_global_flag = GER_BLOCKED_KAISER
					has_government = fascism
					FROM = {
						original_tag = HOL
					}
					OR = {
						7 = { is_controlled_by = GER }
						HOL = { is_subject_of = GER }
					}
				}
				country_event = { id = ger_kaiser_in_exile.7 }
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = HOL
					GER = {
						has_global_flag = GER_BLOCKED_KAISER
						has_war_with = HOL
					}
				}
				GER = {
					country_event = {
						id = ger_kaiser_in_exile.7
						hours = 3
					}
					clr_global_flag = GER_BLOCKED_KAISER
				}
			}
		}
	}
	on_annex = {
		effect = {
			if = {
				limit = {
					tag = HOL
					GER = {
						has_global_flag = GER_BLOCKED_KAISER
						has_war_with = HOL
					}
				}
				GER = {
					country_event = {
						id = ger_kaiser_in_exile.7
						hours = 3
					}
					clr_global_flag = GER_BLOCKED_KAISER
				}
			}
		}
	}
	on_puppet = {
		effect = {
			if = {
				limit = {
					tag = HOL
					GER = {
						has_global_flag = GER_BLOCKED_KAISER
						has_war_with = HOL
					}
				}
				GER = {
					country_event = {
						id = ger_kaiser_in_exile.7
						hours = 3
					}
					clr_global_flag = GER_BLOCKED_KAISER
				}
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = POL
					NOT = {
						has_global_flag = GER_CAP_POL
					}
					GER = {
						has_completed_focus = GER_danzig_or_war
						has_war_with = POL
						OR = {
							has_war_with = ENG
							has_war_with = FRA
						}
					}
				}
				GER = {
					country_event = {
						id = ger_around_maginot_event.1
						hours = 6
					}
					set_global_flag = GER_CAP_POL
				}
			}
		}
	}
	on_puppet = {
		effect = {
			if = {
				limit = {
					tag = POL
					NOT = {
						has_global_flag = GER_CAP_POL
					}
					GER = {
						has_completed_focus = GER_danzig_or_war
						has_war_with = POL
					}
				}
				GER = {
					country_event = {
						id = ger_around_maginot_event.1
						hours = 6
					}
					set_global_flag = GER_CAP_POL
				}
			}
		}
	}
	on_annex = {
		effect = {
			if = {
				limit = {
					tag = POL
					NOT = {
						has_global_flag = GER_CAP_POL
					}
					GER = {
						has_completed_focus = GER_danzig_or_war
						has_war_with = POL
					}
				}
				GER = {
					country_event = {
						id = ger_around_maginot_event.1
						hours = 6
					}
					set_global_flag = GER_CAP_POL
				}
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = ENG
					GER_rudolf_hess = {
						has_character_flag = rudolf_aressted_by_uk
					}
					GER = {
						has_war_with = ENG
					}
				}
				GER_rudolf_hess = {
					clr_character_flag = rudolf_aressted_by_uk
					set_portraits = {
						army={
							small="GFX_idea_rudolf_hess"
						}
					}
				}
			}
		}
	}
	on_puppet = {
		effect = {
			if = {
				limit = {
					tag = ENG
					GER_rudolf_hess = {
						has_character_flag = rudolf_aressted_by_uk
					}
					GER = {
						has_war_with = ENG
					}
				}
				GER_rudolf_hess = {
					clr_character_flag = rudolf_aressted_by_uk
					set_portraits = {
						army={
							small="GFX_idea_rudolf_hess"
						}
					}
				}
			}
		}
	}
	on_annex = {
		effect = {
			if = {
				limit = {
					tag = ENG
					GER = {
						has_war_with = ENG
					}
					GER_rudolf_hess = {
						has_character_flag = rudolf_aressted_by_uk
					}
				}
				GER_rudolf_hess = {
					clr_character_flag = rudolf_aressted_by_uk
					set_portraits = {
						army={
							small="GFX_idea_rudolf_hess"
						}
					}
				}
			}
		}
	}
	on_declare_war = {
		effect = {
			if = {
				limit = {
					has_country_flag = WTT_support_from_soviet
				}
				PRC_soviet_tribute_clear_all = yes
				clr_country_flag = WTT_support_from_soviet
			}
			FROM = {
				if = {
					limit = {
						has_country_flag = WTT_support_from_soviet
					}
					PRC_soviet_tribute_clear_all = yes
					clr_country_flag = WTT_support_from_soviet
				}
			}
			if = {
				limit = {
					OR = {
						AND = {
							tag = GER
							FROM = {
								tag = SOV
							}
						}
						AND = {
							tag = SOV
							FROM = {
								tag = GER
							}
						}
					}
					GER = {
						has_completed_focus = GER_ussr_war_goal
					}
				}
				hidden_effect = {
					set_global_flag = GER_Operation_Barbarossa_running
					complete_national_focus = GER_Attack_SOV
					every_state = {
						limit = {
							OR = {
								state = 93
								state = 91
								state = 89
								state = 199
								state = 201
								state = 198
								state = 202
								state = 193
								state = 192
								state = 203
								state = 197
								state = 225
								state = 259
								state = 226
								state = 196
								state = 200
								state = 221
								state = 228
								state = 227
								state = 97
								state = 94
								state = 95
								state = 96
								state = 194
								state = 204
								state = 206
								state = 207
								state = 241
								state = 11
								state = 784
								state = 189
								state = 12
								state = 190
								state = 13
								state = 191
								state = 814
								state = 815
								state = 809
								state = 808
								state = 810
								state = 813
								state = 812
								state = 811
								state = 181
								state = 149
								state = 209
								state = 210
								state = 244
								state = 264
								state = 263
								state = 247
								state = 246
								state = 242
								state = 219
								state = 243
								state = 205
								state = 224
								state = 222
								state = 223
								state = 254
								state = 457
								state = 258
								state = 257
								state = 240
								state = 260
								state = 265
								state = 245
								state = 218
								state = 217
								state = 236
								state = 237
								state = 238
								state = 234
								state = 235
								state = 232
								state = 233
								state = 827
								state = 828
								state = 821
								state = 826
								state = 231
								state = 229
								state = 230
								state = 834
								state = 137
								state = 220
								state = 208
								state = 195
								state = 188
							}
						}
						set_state_flag = GER_Claim_lands
					}
					every_country = {
						limit = {
							is_puppet_of = SOV
						}
						set_country_flag = GER_SOV_PUPPET_COUNTRY
					}
					SOV = {
						add_ideas = SOV_Great_Patriotic_War
					}
					
					if = {
						limit = {
							GER = {
								has_completed_focus = GER_tank_warfare
							}
						}
						GER = {
							add_timed_idea = {
								idea = GER_barbarossa
								days = 180
							}
							set_variable = {
								GER_Operation_Barb_time = 180
							}
							activate_mission = GER_conquer_Leningrad
							activate_mission = GER_conquer_Misk
							activate_mission = GER_conquer_Moscow
							activate_mission = GER_conquer_Kiev
							activate_mission = GER_conquer_Stalingrad
							activate_mission = GER_conquer_Sevastopol
						}
					}
					if = {
						limit = {
							GER = {
								has_completed_focus = GER_Battle_Plan
							}
						}
						GER = {
							add_timed_idea = {
								idea = GER_barbarossa
								days = 365
							}
							set_variable = {
								GER_Operation_Barb_time = 365
							}
							activate_mission = GER_conquer_Leningrad
							activate_mission = GER_conquer_Misk
							activate_mission = GER_conquer_Moscow
							activate_mission = GER_conquer_Stalingrad
							activate_mission = GER_conquer_Kiev
							activate_mission = GER_conquer_Sevastopol
						}
					}
					else = {
						GER = {
							add_timed_idea = {
								idea = GER_barbarossa
								days = 180
							}
							set_variable = {
								GER_Operation_Barb_time = 180
							}
							activate_mission = GER_conquer_Leningrad
							activate_mission = GER_conquer_Misk
							activate_mission = GER_conquer_Moscow
							activate_mission = GER_conquer_Stalingrad
							activate_mission = GER_conquer_Kiev
							activate_mission = GER_conquer_Sevastopol
						}
					}
				}
			}
		}
	}

	on_civil_war_end_before_annexation = {
		effect = {
			if = {
				limit = {
					original_tag = GER
					has_government = neutrality
				}
				random_other_country = {
					limit = {
						original_tag = GER
						has_government = fascism
					}
					transfer_navy = {
						target = GER
					}
					every_unit_leader = {
						limit = {
							OR = {
								has_id = 10
								has_id = 15
								has_id = 20
								has_id = 24
							}
						}
						set_nationality = GER
					}
				}
			}
		}
	}

	on_declare_war = {
		effect = {
			if = {
				limit = {
					tag = GER
					has_global_flag = GER_nohelp_denmark
					FROM = {
						tag = DEN
					}
				}
				DEN = {
					add_timed_idea = {
						idea = nohelp_denmark
						days = 7
					}
				}
			}
		}
	}
	on_declare_war = {
		effect = {
			if = {
				limit = {
					tag = GER
					FROM = {
						tag = ENG
					}
					has_completed_focus = GER_establish_abwehr
				}
				GER = {
					complete_national_focus = GER_war_with_britain
				}
			}
		}
	}
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					tag = GER
					FROM = {
						tag = ENG
					}
					has_completed_focus = GER_establish_abwehr
				}
				GER = {
					complete_national_focus = GER_war_with_britain
				}
			}
		}
	}
	on_declare_war = {
		effect = {
			if = {
				limit = {
					tag = GER
					FROM = {
						tag = ENG
					}
					has_completed_focus = GER_operation_sealion
					has_idea = Operation_Sea_Lion
				}
				GER = {
					activate_mission = GER_plan_working_fine_or_not
					activate_mission = GER_dover_portsmouth_subtraction
					activate_mission = GER_plymouth_subtraction
				}
			}
		}
	}
}
