on_actions = {


	on_startup = {
		effect = {
			GER = {
				remove_ideas = Wehrmacht
				remove_ideas = Luftwaffe
				remove_ideas = Kriegsmarine
				add_ideas = Wehrmacht_Main_inf
				add_ideas = Luftwaffe_debuff
				add_ideas = Kriegsmarine_Debuff_Version
			}
		}
	}

	on_join_faction = {
		effect = {
			if = {
				limit = {
					NOT = { has_global_flag = DONT_ABUSE_ITA_FACTION }
					original_tag = ITA
					has_government = fascism
					ITA = {
						has_war_with = ETH 
						is_ai = yes 
					}
					ETH = {
						has_war_with = ITA
						exiled = yes
					}
				}
				ITA = {
					add_ideas = ita_dont_core_about_eth
				}
				set_global_flag = DONT_ABUSE_ITA_FACTION
			}
		}
	}

    on_state_control_changed = {
		effect = {
			if = { 
				limit = {
					FROM = {
						original_tag = GER
						has_war = yes
						has_power_balance = { id = GER_power_balance }
						is_power_balance_side_active = {
							id = GER_power_balance
							side = default_left_side
						}
					}
					FROM.FROM = {
						is_owned_by = GER
					}
				}
				if = { 
					limit = {
						FROM.FROM = {
							is_core_of = GER
						}
					}
					if = {
						limit = {
							FROM = { check_variable = { GER_lost_core = 0 } }
						}
						FROM = {
							set_variable = { GER_lost_core = FROM.FROM }
							country_event = { id = ger_lost_core.1 hours = 1 }
						}
					}
					else = { 
						GER_bop_medium_decrease_effect = yes
						GER_bop_increase_lost_core_modifier = yes
					}
					
				}
			}
			else_if = { 
				limit = {
					ROOT = {
						original_tag = GER
						has_war = yes
						has_power_balance = { id = GER_power_balance }
						is_power_balance_side_active = {
							id = GER_power_balance
							side = default_right_side
						}
					}
					FROM.FROM = {
						is_owned_by = GER
					}
				}
				if = {
					limit = {
						FROM.FROM = {
							is_core_of = GER
						}
					}
					if = { 
						limit = {
							check_variable = { GER_reclaimed_core = 0 }
						}
						
						set_variable = { GER_reclaimed_core = FROM.FROM }
						country_event = { id = ger_lost_core.2 hours = 1 }
					}
					else = {
						GER_bop_medium_increase_effect = yes
						GER_bop_decrease_lost_core_modifier = yes
					}
				}
				else = {
					GER_bop_very_low_increase_effect = yes
				}
			}
		}
    }

	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = HOL
					NOT = { has_global_flag = GER_CAP_HOL_KAISER }
					GER = {
						has_global_flag = GER_BLOCKED_KAISER
						has_war_with = HOL
					}
				}
				GER = {
					country_event = { id = ger_kaiser_in_exile.6 hours = 3 }  
					set_global_flag = GER_CAP_HOL_KAISER
				}
			}
		}
	}

	on_puppet = {
		effect = {
			if = {
				limit = {
					tag = HOL
					NOT = { has_global_flag = GER_CAP_HOL_KAISER }
					GER = {
						has_global_flag = GER_BLOCKED_KAISER
						has_war_with = HOL
					}
				}
				GER = {
					country_event = { id = ger_kaiser_in_exile.6 hours = 3 }  
					set_global_flag = GER_CAP_HOL_KAISER
				}
			}
		}
	}

	on_annex = {
		effect = {
			if = {
				limit = {
					tag = HOL
					NOT = { has_global_flag = GER_CAP_HOL_KAISER }
					GER = {
						has_global_flag = GER_BLOCKED_KAISER
						has_war_with = HOL
					}
				}
				GER = {
					country_event = { id = ger_kaiser_in_exile.6 hours = 3 } 
					set_global_flag = GER_CAP_HOL_KAISER
				}
			}
		}
	}

	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = POL
					NOT = { has_global_flag = GER_CAP_POL }
					GER = {
						has_completed_focus = GER_danzig_or_war
						has_war_with = POL
						OR = {
							has_war_with = ENG
							has_war_with = FRA
						}
					}
				}
				GER = {
					country_event = { id = ger_around_maginot_event.1 hours = 6 } 
					set_global_flag = GER_CAP_POL
				}
			}
		}
	}

	on_puppet = {
		effect = {
			if = {
				limit = {
					tag = POL
					NOT = { has_global_flag = GER_CAP_POL }
					GER = {
						has_completed_focus = GER_danzig_or_war
						has_war_with = POL
					}
				}
				GER = {
					country_event = { id = ger_around_maginot_event.1 hours = 6 } 
					set_global_flag = GER_CAP_POL
				}
			}
		}
	}

	on_annex = {
		effect = {
			if = {
				limit = {
					tag = POL
					NOT = { has_global_flag = GER_CAP_POL }
					GER = {
						has_completed_focus = GER_danzig_or_war
						has_war_with = POL
					}
				}
				GER = {
					country_event = { id = ger_around_maginot_event.1 hours = 6 } 
					set_global_flag = GER_CAP_POL
				}
			}
		}
	}	
	
	on_declare_war = {
		effect = {
			if = {
				limit = { has_country_flag = WTT_support_from_soviet }
				PRC_soviet_tribute_clear_all = yes
				clr_country_flag = WTT_support_from_soviet
			}
			FROM = {
				if = {
					limit = { has_country_flag = WTT_support_from_soviet }
					PRC_soviet_tribute_clear_all = yes
					clr_country_flag = WTT_support_from_soviet
				}
			}
			if = {
				limit = {
					OR = {
						AND = {
							tag = GER
							FROM = { tag = SOV }
						}
						AND = {
							tag = SOV
							FROM = { tag = GER }
						}
					}
					GER = { has_completed_focus = GER_ussr_war_goal }
				}
				hidden_effect = {
					set_global_flag = GER_Operation_Barbarossa_running
					complete_national_focus = GER_Attack_SOV
					every_state = {
						limit = { 
							is_owned_and_controlled_by = SOV 
						} 
						set_state_flag = GER_Claim_lands
					}
					if = {
						limit = {
							GER = {
								has_completed_focus = GER_tank_warfare
							}
						}
						GER = { 
							add_timed_idea = { idea = GER_barbarossa days = 180 }
							set_variable = { GER_Operation_Barb_time = 180 }
							activate_mission = GER_conquer_Leningrad
							activate_mission = GER_conquer_Moscow
							activate_mission = GER_conquer_Stalingrad
						}
					}
					if = {
						limit = {
							GER = {
								has_completed_focus = GER_Battle_Plan
							}
						}
						GER = { 
							add_timed_idea = { idea = GER_barbarossa days = 365 }
							set_variable = { GER_Operation_Barb_time = 365 }
							activate_mission = GER_conquer_Leningrad
							activate_mission = GER_conquer_Moscow
							activate_mission = GER_conquer_Stalingrad
						}
					}
					else = {
						GER = { 
							add_timed_idea = { idea = GER_barbarossa days = 180 }
							set_variable = { GER_Operation_Barb_time = 180 }
							activate_mission = GER_conquer_Leningrad
							activate_mission = GER_conquer_Moscow
							activate_mission = GER_conquer_Stalingrad
						}
					}
				}
			}
		}
	}

	on_declare_war = {
		effect = {
			if = {
				limit = {
					tag = GER
					has_global_flag = GER_nohelp_denmark
					FROM = { tag = DEN }
				}
				DEN = {
					add_timed_idea = {
						idea = nohelp_denmark
						days = 7
					}
				}
			}
		}
	}

	on_declare_war = {
		effect = {
			if = {
				limit = {
					tag = GER
					has_completed_focus = GER_strike_union
					FROM = { tag = SOV }
				}
				add_ideas = GER_strike_union
				hidden_effect = {
					sound_effect = war_sov
				}
			}
		}
	}

}
